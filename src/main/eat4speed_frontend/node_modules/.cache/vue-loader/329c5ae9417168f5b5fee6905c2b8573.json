{"remainingRequest":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\src\\components\\Cart.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\src\\components\\Cart.vue","mtime":1620997186481},{"path":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\mosab\\IdeaProjects\\Eat4Speed\\src\\main\\eat4speed_frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJDYXJ0IiwNCiAgbW91bnRlZCgpIHsNCiAgICB0aGlzLmxvYWRHZXJpY2h0ZUZyb21TdG9yZSgpOw0KICB9LA0KICBiZWZvcmVSb3V0ZUxlYXZlKHRvLCBmcm9tLCBuZXh0KSB7DQogICAgdGhpcy5zZXRTdG9yZVNlYXJjaFN0cmluZygpOw0KICAgIG5leHQoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHNldFN0b3JlU2VhcmNoU3RyaW5nKCkgew0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJjaGFuZ2VTZWFyY2hTdHJpbmciLCB0aGlzLnNlYXJjaFN0cmluZyk7DQogICAgICBpZiAodGhpcy5zZWFyY2hEZXN0aW5hdGlvbiA9PT0gIkdlcmljaHRlIikgew0KICAgICAgICBjb25zdCBzZWFyY2hPcHRpb25zID0gew0KICAgICAgICAgIGdlcmljaHRfSUQ6IC0xLA0KICAgICAgICAgIGdlcmljaHROYW1lOiB0aGlzLnNlYXJjaFN0cmluZywNCiAgICAgICAgICBrYXRlZ29yaWVuOiBbXSwNCiAgICAgICAgICBleGNsdWRlZEFsbGVyZ2VuZTogW10sDQogICAgICAgICAgbWF4TWluZGVzdGJlc3RlbGx3ZXJ0OiAwLA0KICAgICAgICAgIG1heEVudGZlcm51bmc6IDAsDQogICAgICAgICAgbWluQmV3ZXJ0dW5nOiAwLA0KICAgICAgICAgIHVzZU5hbWU6IHRydWUsDQogICAgICAgICAgdXNlS2F0ZWdvcmllbjogZmFsc2UsDQogICAgICAgICAgdXNlQWxsZXJnZW5lOiBmYWxzZSwNCiAgICAgICAgICB1c2VNaW5kZXN0YmVzdGVsbHdlcnQ6IGZhbHNlLA0KICAgICAgICAgIHVzZUVudGZlcm51bmc6IGZhbHNlLA0KICAgICAgICAgIHVzZUJld2VydHVuZzogZmFsc2UNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImNoYW5nZVNlYXJjaE9wdGlvbnMiLCBzZWFyY2hPcHRpb25zKTsNCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJjaGFuZ2VTZWFyY2hUeXBlIiwgIkdlcmljaHRlIik7DQogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAnS3VuZGUnfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImNoYW5nZVNlYXJjaFR5cGUiLCAiUmVzdGF1cmFudHMiKQ0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7cGF0aDogJy9rdW5kZVJlc3RhdXJhbnRzJ30pOw0KICAgICAgfQ0KICAgIH0sDQogICAgc2V0RGVzdGluYXRpb25Ub0dlcmljaHRlKCkgew0KICAgICAgdGhpcy5zZWFyY2hEZXN0aW5hdGlvbiA9ICJHZXJpY2h0ZSI7DQogICAgfSwNCiAgICBzZXREZXN0aW5hdGlvblRvUmVzdGF1cmFudHMoKSB7DQogICAgICB0aGlzLnNlYXJjaERlc3RpbmF0aW9uID0gIlJlc3RhdXJhbnRzIjsNCiAgICB9LA0KICAgIHNlbGVjdEdlcmljaHQoaXRlbSkgew0KICAgICAgdGhpcy5zZWxlY3RlZEdlcmljaHQgPSBpdGVtOw0KICAgIH0sDQogICAgbG9hZEdlcmljaHRlRnJvbVN0b3JlKCkgew0KICAgICAgdGhpcy5jYXJ0cyA9IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q2FydEdlcmljaHRlOw0KICAgICAgdGhpcy52ZXJzaW9uKys7DQogICAgfSwNCiAgICBkZWxldGVHZXJpY2h0RnJvbVN0b3JlKCkgew0KICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJyZW1vdmVGcm9tQ2FydEdlcmljaHRlIiwgdGhpcy5zZWxlY3RlZEdlcmljaHQpOw0KICAgICAgdGhpcy5sb2FkR2VyaWNodGVGcm9tU3RvcmUoKTsNCiAgICAgIHRoaXMudmVyc2lvbisrOw0KICAgIH0sDQogICAgY2FsY3VsYXRlSXRlbVByaWNlKHByaWNlLCBhbW91bnQpIHsNCiAgICAgIHJldHVybiBwcmljZSAqIGFtb3VudDsNCiAgICB9LA0KICAgIGNhbGN1bGF0ZUNhcnRQcmljZSgpIHsNCiAgICAgIGxldCBjYXJ0UHJpY2UgPSAwOw0KICAgICAgdGhpcy5jYXJ0cy5mb3JFYWNoKHZhbHVlID0+IHsNCiAgICAgICAgY2FydFByaWNlID0gY2FydFByaWNlICsgdGhpcy5jYWxjdWxhdGVJdGVtUHJpY2UodmFsdWUucXVhbnRpdHksIHZhbHVlLnByaWNlKTsNCiAgICAgIH0pOw0KICAgICAgcmV0dXJuIGNhcnRQcmljZTsNCiAgICB9LA0KICAgIGFzeW5jIGdldEN1c3RvbWVySWQoKSB7DQogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuJGh0dHAucG9zdCgiL0JlbnV0emVyL2dldElkQnlFbWFpbCIsIHsgZW1haWw6IHRoaXMuJHN0b3JlLmdldHRlcnMuZ2V0TG9naW5EYXRhLmF1dGgudXNlcm5hbWUgfSk7DQogICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTsNCiAgICB9LA0KICAgIGFzeW5jIHBheXBhbFJlcXVlc3QoKSB7DQogICAgICBjb25zdCBpdGVtcyA9IFtdOw0KICAgICAgdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDYXJ0R2VyaWNodGUuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbXMucHVzaChpdGVtLmdlcmljaHRfSUQpOw0KICAgICAgfSk7DQoNCiAgICAgIGNvbnN0IGN1c3RvbWVySWQgPSBhd2FpdCB0aGlzLmdldEN1c3RvbWVySWQoKTsNCg0KICAgICAgdGhpcy4kaHR0cC5wb3N0KCcvQmVzdGVsbHVuZy9hZGQnLCB7DQogICAgICAgIGl0ZW1zOiBpdGVtcywNCiAgICAgICAgY3VzdG9tZXJJZDogY3VzdG9tZXJJZA0KICAgICAgfSkudGhlbigocmVzcG9uc2UpID0+IHsNCiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAxKSB7DQogICAgICAgICAgY29uc29sZS5sb2coJ3N1Y2Nlc3MnKTsNCiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImRlbGV0ZUNhcnRHZXJpY2h0ZSIpOw0KICAgICAgICAgIHRoaXMudmVyc2lvbisrOw0KICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHtuYW1lOiAiQmV6YWhsdW5nRXJmb2xncmVpY2giLCBwYXJhbXM6IHtjYXJ0OiB0aGlzLmNhcnRzfX0pOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9DQogIH0sDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIGNhcnRzOiBbXSwNCiAgICAgIHZlcnNpb246IDAsDQogICAgICBzZWxlY3RlZEdlcmljaHQ6ICIiLA0KICAgICAgc2VhcmNoU3RyaW5nOiAiIiwNCiAgICAgIHNlYXJjaERlc3RpbmF0aW9uOiAiIg0KICAgIH07DQogIH0sDQp9DQo="},{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <v-menu offset-y>\r\n    <template v-slot:activator=\"{on}\">\r\n      <v-btn v-on=\"on\" @click=\"loadGerichteFromStore\" icon>\r\n        <v-icon>mdi-cart</v-icon>\r\n        <!-- <v-badge v-if=\"totalItem > 0\" :content=\"totalItem\" inline>\r\n        </v-badge>\r\n        -->\r\n      </v-btn>\r\n      <v-container>\r\n        <v-row>\r\n          <v-text-field placeholder=\"Suche...\" autofocus clearable\r\n                        v-model=\"searchString\"\r\n          ></v-text-field>\r\n          <v-btn @click=\"setStoreSearchString\"\r\n          >Suchen\r\n          </v-btn>\r\n          <v-btn @click=\"setDestinationToGerichte\">Gericht</v-btn>\r\n          <v-btn @click=\"setDestinationToRestaurants\">Umgebung</v-btn>\r\n        </v-row>\r\n      </v-container>\r\n\r\n    </template>\r\n    <v-card width=\"400\">\r\n      <v-list>\r\n        <v-list-item>\r\n\r\n          <v-list-item-content>\r\n            <v-list-item-title class=\"headline font-weight-bold\">Cart</v-list-item-title>\r\n          </v-list-item-content>\r\n\r\n        </v-list-item>\r\n      </v-list>\r\n\r\n      <v-divider></v-divider>\r\n      <v-card-text v-if=\"carts.length > 0\">\r\n\r\n        <v-list :key=\"version\">\r\n\r\n          <v-list-item v-for=\"(item, idx) in carts\" :key=\"idx\">\r\n            <v-list-item-avatar>\r\n              <img :src=\"item.thumbnail\">\r\n            </v-list-item-avatar>\r\n\r\n            <v-list-item-content>\r\n              <v-list-item-title>{{ item.name }}</v-list-item-title>\r\n              <v-list-item-subtitle>Anzahl: {{ item.quantity }}</v-list-item-subtitle>\r\n              <v-list-item-subtitle>{{ calculateItemPrice(item.quantity, item.price) }} &euro;</v-list-item-subtitle>\r\n            </v-list-item-content>\r\n\r\n            <v-list-item-action>\r\n              <v-btn icon @mouseover=\"selectGericht(item)\" @click=\"deleteGerichtFromStore\" small>\r\n                <v-icon>mdi-delete</v-icon>\r\n              </v-btn>\r\n            </v-list-item-action>\r\n          </v-list-item>\r\n\r\n\r\n        </v-list>\r\n\r\n        <v-divider></v-divider>\r\n\r\n        <h2 class=\"pt-2\">Endpreis: {{ calculateCartPrice() }} &euro;</h2>\r\n\r\n        <v-card-actions>\r\n          <v-btn block color=\"primary\" rounded @click=\"paypalRequest()\">\r\n            Checkout\r\n          </v-btn>\r\n        </v-card-actions>\r\n      </v-card-text>\r\n\r\n      <v-card-text v-else>\r\n        <p>No item</p>\r\n      </v-card-text>\r\n\r\n    </v-card>\r\n\r\n  </v-menu>\r\n\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Cart\",\r\n  mounted() {\r\n    this.loadGerichteFromStore();\r\n  },\r\n  beforeRouteLeave(to, from, next) {\r\n    this.setStoreSearchString();\r\n    next();\r\n  },\r\n  methods: {\r\n    setStoreSearchString() {\r\n      this.$store.commit(\"changeSearchString\", this.searchString);\r\n      if (this.searchDestination === \"Gerichte\") {\r\n        const searchOptions = {\r\n          gericht_ID: -1,\r\n          gerichtName: this.searchString,\r\n          kategorien: [],\r\n          excludedAllergene: [],\r\n          maxMindestbestellwert: 0,\r\n          maxEntfernung: 0,\r\n          minBewertung: 0,\r\n          useName: true,\r\n          useKategorien: false,\r\n          useAllergene: false,\r\n          useMindestbestellwert: false,\r\n          useEntfernung: false,\r\n          useBewertung: false\r\n        }\r\n        this.$store.commit(\"changeSearchOptions\", searchOptions);\r\n        this.$store.commit(\"changeSearchType\", \"Gerichte\");\r\n        this.$router.push({name: 'Kunde'});\r\n      } else {\r\n        this.$store.commit(\"changeSearchType\", \"Restaurants\")\r\n        this.$router.push({path: '/kundeRestaurants'});\r\n      }\r\n    },\r\n    setDestinationToGerichte() {\r\n      this.searchDestination = \"Gerichte\";\r\n    },\r\n    setDestinationToRestaurants() {\r\n      this.searchDestination = \"Restaurants\";\r\n    },\r\n    selectGericht(item) {\r\n      this.selectedGericht = item;\r\n    },\r\n    loadGerichteFromStore() {\r\n      this.carts = this.$store.getters.getCartGerichte;\r\n      this.version++;\r\n    },\r\n    deleteGerichtFromStore() {\r\n      this.$store.commit(\"removeFromCartGerichte\", this.selectedGericht);\r\n      this.loadGerichteFromStore();\r\n      this.version++;\r\n    },\r\n    calculateItemPrice(price, amount) {\r\n      return price * amount;\r\n    },\r\n    calculateCartPrice() {\r\n      let cartPrice = 0;\r\n      this.carts.forEach(value => {\r\n        cartPrice = cartPrice + this.calculateItemPrice(value.quantity, value.price);\r\n      });\r\n      return cartPrice;\r\n    },\r\n    async getCustomerId() {\r\n      const response = await this.$http.post(\"/Benutzer/getIdByEmail\", { email: this.$store.getters.getLoginData.auth.username });\r\n      return response.data;\r\n    },\r\n    async paypalRequest() {\r\n      const items = [];\r\n      this.$store.getters.getCartGerichte.forEach(item => {\r\n        items.push(item.gericht_ID);\r\n      });\r\n\r\n      const customerId = await this.getCustomerId();\r\n\r\n      this.$http.post('/Bestellung/add', {\r\n        items: items,\r\n        customerId: customerId\r\n      }).then((response) => {\r\n        if (response.status === 201) {\r\n          console.log('success');\r\n          this.$store.commit(\"deleteCartGerichte\");\r\n          this.version++;\r\n          this.$router.push({name: \"BezahlungErfolgreich\", params: {cart: this.carts}});\r\n        }\r\n      });\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      carts: [],\r\n      version: 0,\r\n      selectedGericht: \"\",\r\n      searchString: \"\",\r\n      searchDestination: \"\"\r\n    };\r\n  },\r\n}\r\n</script>"]}]}